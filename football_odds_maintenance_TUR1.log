2025-08-21 19:14:51,408 - INFO - Logging configurÃ© pour Ã©crire dans football_odds_maintenance_TUR1.log
2025-08-21 19:14:51,408 - INFO - ðŸš€ === DÃ‰BUT DE LA MAINTENANCE DES COTES ===
2025-08-21 19:14:51,408 - INFO - --- Traitement de la ligue : TUR1 ---
2025-08-21 19:14:51,494 - INFO - [TUR1] Suppression : 0 enregistrements anciens supprimÃ©s.
2025-08-21 19:14:51,498 - ERROR - âŒ Erreur majeure lors du traitement de TUR1: Invalid comparison between dtype=datetime64[ns] and date
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2025-08-14

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/runner/work/Full/Full/football_odds_collector.py", line 199, in run_maintenance
    self.process_league(league_code)
  File "/home/runner/work/Full/Full/football_odds_collector.py", line 163, in process_league
    fixtures_to_check = self.get_fixtures_to_collect(league_code)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/Full/Full/football_odds_collector.py", line 138, in get_fixtures_to_collect
    mask = (df['date'] >= self.collection_start_date) & (df['date'] <= self.collection_end_date)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pandas/core/arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pandas/core/series.py", line 6130, in _cmp_method
    res_values = ops.comparison_op(lvalues, rvalues, op)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
    res_values = op(lvalues, rvalues)
                 ^^^^^^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pandas/core/arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
2025-08-21 19:14:51,502 - INFO - 
ðŸŽ‰ === MAINTENANCE TERMINÃ‰E ===
